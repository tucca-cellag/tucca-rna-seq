# config/config.yaml

# ----------------------------------------------------------
# This is the main configuration file for the 'tucca-rna-seq' workflow
#
# For instructions on how to set up the workflow please refer to our
# documentation at:
# https://tucca-cellag.github.io/tucca-rna-seq/introduction
#
# If you cannot find a satisfactory answer in our documentation, please let us
# know about your issue on our GitHub page, so we can assist you further:
# https://github.com/tucca-cellag/tucca-rna-seq/issues/new
# ----------------------------------------------------------

# ----------------------------------------------------------
# Genome Section
#
# This section defines the reference genome parameters
#
# - source: Specify either "RefSeq", "Ensembl", or "GENCODE"
#     • RefSeq info: https://www.ncbi.nlm.nih.gov/refseq/about/
#     • Ensembl info: https://ensembl.org/info/genome/genebuild/assembly.html
#     • Comparison: https://www.ncbi.nlm.nih.gov/books/NBK50679/#RefSeqFAQ.what_is_the_difference_between_1
#     • GENCODE info: https://www.gencodegenes.org/pages/gencode.html
#
# - accession: The genome’s GenBank or RefSeq accession number
#     (See: https://www.ncbi.nlm.nih.gov/datasets/genome/)
#
# - name: The name assigned to the genome assembly (build)
#
# - release: The release of the Ensembl or GENCODE assembly (not required for RefSeq assemblies)
#
# - species: Scientific name in the format "Genus_species" (e.g., "Gallus_gallus")
#
# ----------------------------------------------------------
ref_assembly:
  source: "Ensembl"
  accession: "GCA_000146045.2"
  name: "R64-1-1"
  release: "113"
  species: "Saccharomyces_cerevisiae"

# ----------------------------------------------------------
# NCBI API Key
#
# RECOMMENDED: Use a .env file instead of setting the API key here.
# The .env file is git-ignored and prevents accidental commits of secrets.
#
# To use .env file:
#   1. Copy the template: cp .env.template .env
#   2. Edit .env and add your API key: NCBI_API_KEY=your_key_here
#
# The workflow will automatically load the API key from:
#   1. NCBI_API_KEY environment variable (highest priority)
#   2. .env file (if NCBI_API_KEY is set in the file)
#   3. This config file (fallback, deprecated)
#
# To avoid potential rate-limiting issues when downloading data from NCBI,
# you can provide an API key. The key will be used by the 'ncbi-datasets-cli'
# tool, which is used for fetching genomes and SRA datasets.
#
# For instructions on how to obtain an API key, please visit:
# https://account.ncbi.nlm.nih.gov/settings/
# ----------------------------------------------------------
api_keys:
  ncbi: "" # Leave empty - use .env file or environment variable instead

# ----------------------------------------------------------
# Read Quality Control and Quantification
#
# This section configures the initial stages of the workflow, from quality
# control (QC) of raw sequencing reads to the generation of feature counts.
# The parameters below for each tool allow for fine-tuning the pipeline's
# performance and behavior.
# ----------------------------------------------------------
params:
  star_index:
    extra: "--genomeSAindexNbases 10" # for small genomes (eg. Sc)

# ----------------------------------------------------------
# Differential Expression Section:
#
# This section defines the parameters for the differential gene expression
# analysis. It allows you to specify the experimental design, including the
# factors and contrasts to be analyzed with DESeq2. You can configure multiple
# analyses, each with its own formula and settings, to explore different
# aspects of your data.
# ----------------------------------------------------------
diffexp:
  tximeta:
    factors:
      - name: "treatment1"
        reference_level: "untreated"
      - name: "treatment2"
        reference_level: "untreated"
  deseq2:
    analyses:
      - name: "treatment1_treatment2"
        deseqdataset:
          formula: "~ treatment1 + treatment2"
        contrasts:
          - name: "treatment1_treated_vs_untreated"
            elements: ["treatment1", "treated", "untreated"]
          - name: "treatment2_treated_vs_untreated"
            elements: ["treatment2", "treated", "untreated"]
    transform: {}

# ----------------------------------------------------------
# Pathway Enrichment Section:
#
# This section configures the pathway enrichment analysis, which helps to
# interpret the biological meaning of the differentially expressed genes.
# It uses the 'clusterProfiler' R package to perform Over-Representation
# Analysis (ORA) and Gene Set Enrichment Analysis (GSEA) on gene sets from
# GO and KEGG databases.
#
# For more details on 'clusterProfiler', see:
# https://yulab-smu.top/biomedical-knowledge-mining-book/
# ----------------------------------------------------------
enrichment:
  # Adjusted p-value cutoff to define significant genes for ORA
  padj_cutoff: 0.05 # Default is 0.05
  clusterprofiler:
    wikipathways:
      enabled: true
    kegg_module:
      enabled: true
  # MSigDB (Molecular Signatures Database) configuration
  # MSigDB provides gene sets for enrichment analysis using clusterProfiler's
  # universal enrichment functions (enricher() and GSEA()). The workflow supports
  # both built-in MSigDB collections and custom GMT files.
  #
  # Available collections:
  # - H: Hallmark gene sets (50 gene sets)
  # - C1: Positional gene sets (299 gene sets)
  # - C2: Curated gene sets (5,922 gene sets)
  # - C3: Regulatory target gene sets (3,738 gene sets)
  # - C4: Computational gene sets (858 gene sets)
  # - C5: Ontology gene sets (10,922 gene sets)
  # - C6: Oncogenic signatures (189 gene sets)
  # - C7: Immunologic signatures (4,872 gene sets)
  # - C8: Cell type signature gene sets (746 gene sets)
  #
  # For more information, see: https://www.gsea-msigdb.org/gsea/msigdb/
  msigdb:
    enabled: true
    # List of MSigDB collections to analyze (H, C1, C2, C3, C4, C5, C6, C7, C8)
    # For CI/CD testing, use only H (Hallmark) to avoid timeout issues
    collections:
      - "H" # Hallmark gene sets (50 gene sets - suitable for CI/CD)
    # Custom GMT files (optional)
    # Place your GMT files in resources/gmt/ and reference them here
    #
    # To use custom gene sets:
    # 1. Place your GMT file in the resources/gmt/ directory
    # 2. Uncomment the line below and replace "example_genesets.gmt" with your filename
    # 3. Ensure your GMT file follows the standard format (see resources/gmt/README.md)
    # 4. Make sure your gene IDs match the format used in your differential expression analysis
    #
    # Example GMT file format:
    # GENE_SET_1  Description of gene set 1 GENE1 GENE2 GENE3
    # GENE_SET_2  Description of gene set 2 GENE4 GENE5 GENE6 GENE7
    #
    # Available custom gene sets:
    # - muscle_genesets.gmt: 1,517 muscle-related gene sets (see resources/gmt/README.md)
    custom_gmt_files: [] # Example: ["resources/gmt/example_genesets.gmt"]
  # SPIA (Signaling Pathway Impact Analysis) configuration
  # SPIA performs topology-based pathway analysis considering both gene expression
  # changes and pathway structure. It identifies pathways that are significantly
  # perturbed based on the impact of differentially expressed genes on pathway
  # topology. The workflow automatically generates required SPIA data files
  # using makeSPIAdata() before running the analysis.
  #
  # IMPORTANT: SPIA uses the KEGG REST API (rest.kegg.jp) which is made available
  # only for academic use by academic users. Non-academic users are requested to
  # follow the guidelines shown in "Non-academic use of KEGG" at the KEGG website.
  # See: https://www.kegg.jp/kegg/rest/ for API usage restrictions and
  # https://www.kegg.jp/kegg/legal.html for legal information.
  #
  # Rate limiting: The workflow automatically limits API calls to ~2.5 calls per
  # second (well within the KEGG limit of 3 calls per second) to avoid being
  # blocked by the KEGG server.
  spia:
    enabled: true
